<html>
	<head>
		<title>Linux Install Fest</title>
		<script type="text/javascript" src="sheetsee.js/js/ICanHaz.js"></script> 
		<script src='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.js'></script>
		<script src='sheetsee.js/js/jquery.js '></script>
		<script type="text/javascript" src='sheetsee.js/js/d3.js'></script>
		<script type="text/javascript" src='sheetsee.js/js/tabletop.js'></script>
		<script type="text/javascript" src='sheetsee.js/js/sheetsee.js'></script>
		
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.css' rel='stylesheet' />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,600|Merriweather:400,700' rel='stylesheet' />
		<link rel="stylesheet" type="text/css" href="sheetsee.js/css/style.css"> 
		<link rel="stylesheet" type="text/css" href="sheetsee.js/css/site.css"> 
	</head>

<body>
<h1> Linux Install Fest </h1>
<nav>
    <a href="">2013</a> |
    <a href="?key=0AnGjdmqOroGfdHdQYzZBejVzVHlQemM0cGMyZDNIRmc">2012</a> |
    <a href="?key=0AnGjdmqOroGfdGw0WGozLUZVQXRvWGJ5QjNGWW5OaEE">2011</a> |
</nav>
<h1 id="participantNo"></h1>
<div style="float: left;">
<h2> Distributions <h2>
<div id="distributions"></div>
</div>
<div style="float: left;">
<h2> Helpers <h2>
<div id="helpers"></div>
</div>
<div style="clear: both"></div>
<h2> Participants <h2>
<input id="participantsFilter" type="text" placeholder="Search.."></input>
<span class="clear button">Clear</span>
<span class="noMatches">no matches</span>
<div id="participants"></div>
<script id="participants" type="text/html">
<table>
  <tr><th class="tHeader">Name</th><th class="tHeader">Distribution</th><th class="tHeader">Helper</th></tr>
  {{#rows}}
  <tr><td>{{name}}</td><td>{{distribution}}</td><td>{{helper}}</td></tr>
  {{/rows}}
</table>
</script>
	
<script id="" type="text/html">
// template if you so desire!
</script>

<script type="text/javascript">
  // Get URL from request
  var query = window.location.search.substring(1);
  var vars = query.split('&');
  URL = "0AnGjdmqOroGfdHdQYzZBejVzVHlQemM0cGMyZDNIRmc"
  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');
    if (decodeURIComponent(pair[0]) == "key") {
      URL = pair[1]
    }
  }
</script>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
  	var gData
		Tabletop.init( { key: URL, callback: showInfo, simpleSheet: true } ) 
	}) 
  	
  function showInfo(data) {
		gData = data;
    $("#participantNo").html(gData.length + " participants");
    Sheetsee.makeTable(gData, "#participants");
    Sheetsee.initiateTableFilter(gData, "#participantsFilter", "#participants");

    var distributions = Sheetsee.getOccurance(data, "distribution");
    var colors = ["#f0f", "#0f9", "#9f3", "#0ff"]
    var pieData = Sheetsee.makeColorArrayOfObject(distributions, colors, "distribution");
    var pieOptions = {labels: "distribution", units: "units", m: [120, 120, 120, 120],
                      w: 600, h: 400, div: "#distributions", hiColor: "#14ECC8"};
    Sheetsee.d3PieChart(pieData, pieOptions);

    var helpers = Sheetsee.getOccurance(data, "helper");
    var barData = Sheetsee.makeColorArrayOfObject(helpers, colors, "helper");
    var barOptions = {labels: "helper", units: "units", m: [15, 120, 120, 200],
                      w: 800, h: 800, div: "#helpers", hiColor: "#14ECC8"};
    Sheetsee.d3BarChart(barData, barOptions);
  }
</script>

</body>
</html>
