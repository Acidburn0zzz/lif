<html>
	<head>
		<title>Linux Install Fest</title>
		<script type="text/javascript" src="sheetsee.js/js/ICanHaz.js"></script>
		<script src='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.js'></script>
		<script src='sheetsee.js/js/jquery.js '></script>
		<script type="text/javascript" src='sheetsee.js/js/d3.js'></script>
		<script type="text/javascript" src='sheetsee.js/js/tabletop.js'></script>
		<script type="text/javascript" src='sheetsee.js/js/sheetsee.js'></script>
		<script type="text/javascript" src='http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.rc.2/handlebars.min.js'></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.css' rel='stylesheet' />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,600|Merriweather:400,700' rel='stylesheet' />
		<link rel="stylesheet" type="text/css" href="sheetsee.js/css/style.css">
		<link rel="stylesheet" type="text/css" href="sheetsee.js/css/site.css">
		<link rel="stylesheet" type="text/css" href="table.css">
	</head>

  <style>
    body {
      padding: 0px;
      border: 0px;
      background-color: #e0e0e0;
    }

    #lifContent {
      margin: auto;
      width: 1000px;
      min-height: 100%;
      background-color: lightGrey;
      box-shadow: 1px 1px 10px 1px rgba(0, 0, 0, .5);
      border-radius: 5px;
    }

    ::selection {
      background: #999999;
    }

    a {
      border-color: #88C62C;
      color: white;
    }

    a:visited {
      color: white;
      border-color: #88C62C;
    }

    a:hover {
      color: white;
      border-color: #CC3E61;
    }

    .content {
      padding: 10px;
      padding-top: 20px;
    }

    h2 {
      font-size: 20px;
    }

    h1, h2, h3 {
      padding: 0px;
      margin: 0px;
      border: 0px;
    }

    b.largeText {
      font-weight: bold;
      font-size: 45px;
      color: #CC3E61;
    }

    .header {
      margin: 0px;
      border: 0px;
      padding: 10px;
      overflow: auto;
    }

    h1.header {
      height: 50px;
      line-height: 40px;
      font-size: 40px;
      padding-top: 20px;
      padding-bottom: 20px;
    }

    #logo {
      float: right;
      width: 250px;
      border: 0px;
    }

    #logo img {
      width: 80%;
    }

    nav.header {
      font-size: 12px;
      background-color: #1F2121;
      color: white;
      border-radius: 5px;
      box-shadow: 1px 1px 10px 1px rgba(0, 0, 0, .5);
      background-image: linear-gradient(bottom, rgb(0,0,0) 3%, rgb(95,87,102) 52%);
      background-image: -o-linear-gradient(bottom, rgb(0,0,0) 3%, rgb(95,87,102) 52%);
      background-image: -moz-linear-gradient(bottom, rgb(0,0,0) 3%, rgb(95,87,102) 52%);
      background-image: -webkit-linear-gradient(bottom, rgb(0,0,0) 3%, rgb(95,87,102) 52%);
      background-image: -ms-linear-gradient(bottom, rgb(0,0,0) 3%, rgb(95,87,102) 52%);
    }

    #partners {
      padding-top: 110px;
      float: right;
      width: 250px;
    }

    #partners a {
      border: 0px;
    }

    #partners img {
      padding: 10px;
    }

    #partners .sponsor {
      width: 70%;
      padding: 15px;
    }

    #partners .support {
      width: 40%;
    }
  </style>


<body>
<div id=lifContent></div>
<script id="lifTemplate" type="text/x-handlebars-template">
<h1 class="header"> Linux Install Fest {{ year }}
<a id="logo" href="http://rosedu.org"><img src="res/rosedu_logo.png" /></a></h1>
<nav class="header">
    <a href="?year=2013">2013</a> |
    <a href="?year=2012">2012</a> |
    <a href="?year=2011">2011</a> |
</nav>
{{#if partners}}
<div id="partners">
<h2>Partners</h2>
{{#each partners}}
<a href={{this.url}}><img class={{this.type}} src={{this.src}} /></a>
{{/each}}
</div>
{{/if}}
<div>
{{#if participants}}
<div class="content">
<h2> <b class="largeText">{{ participants }}</b> participants </h2>
<div class="content">
<div>
<h2> Distributions </h2>
<div id="distributions"></div>
</div>
<div>
<h2> Helpers </h2>
<div id="helpers"></div>
</div>
<h2> Participants <h2>
<input id="participantsFilter" type="text" placeholder="Search.."></input>
<span class="clear button">Clear</span>
<span class="noMatches">no matches</span>
<div id="participants"></div>
{{else}}
<div class="content">
<b class="largeText"> To be announced </b>
<h1> In the meantime visit our last editions </h1>
</div>
{{/if}}
</script>

<script id="participants" type="text/html">
<table>
  <tr><th class="tHeader">Name</th><th class="tHeader">Distribution</th><th class="tHeader">Helper</th></tr>
  {{#rows}}
  <tr><td>{{name}}</td><td>{{distribution}}</td><td>{{helper}}</td></tr>
  {{/rows}}
</table>
</div>
</script>

<script type="text/javascript">
  // Get URL from request
  var sheet_urls = {
    2013: "0AnGjdmqOroGfdFRJQjhsMUI2cnR2VjhqVVZSaV93d2c",
    2012: "0AnGjdmqOroGfdHdQYzZBejVzVHlQemM0cGMyZDNIRmc",
    2011: "0AnGjdmqOroGfdGw0WGozLUZVQXRvWGJ5QjNGWW5OaEE"
  }
  var partners = {
    2012: [{ url: "http://www.crisoft.ro", src: "res/crisoft.png", type: "sponsor" },
           { url: "http://www.anis.ro", src: "res/anis.png", type: "sponsor"},
           { url: "http://acs.pub.ro", src: "res/cs.png", type: "sponsor"},
           { url: "http://ubuntu.ro", src: "res/ubunturo.png", type: "support"},
           { url: "http://www.fedoraproject.ro", src: "res/fedora.png", type: "support"},
           { url: "http://www.suseromania.ro", src: "res/opensuse.png", type: "support"}
           ],
  }
  var query = window.location.search.substring(1);
  var vars = query.split('&');
  YEAR = 2013
  URL = sheet_urls[YEAR]
  PARTNERS = partners[YEAR]
  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');
    if (decodeURIComponent(pair[0]) == "year") {
      YEAR = pair[1]
      URL = sheet_urls[YEAR]
      PARTNERS = partners[YEAR]
    }
  }
</script>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
  	var gData
		Tabletop.init( { key: URL, callback: showInfo, simpleSheet: true } )
	})

  function showInfo(data) {
		gData = data;
    var source = $("#lifTemplate").html();
    var template = Handlebars.compile(source);
    var context  = {year: YEAR, participants: gData.length, partners: PARTNERS};
    var html     = template(context);
    $("#lifContent").html(html);

    Sheetsee.makeTable(gData, "#participants");
    Sheetsee.initiateTableFilter(gData, "#participantsFilter", "#participants");

    var distributions = Sheetsee.getOccurance(data, "distribution");
    var colors = ["#CC3E61", "#88C62C", "#138B43"]
    var pieData = Sheetsee.makeColorArrayOfObject(distributions, colors, "distribution");
    var pieOptions = {labels: "distribution", units: "units", m: [120, 120, 120, 120],
                      w: 600, h: 400, div: "#distributions", hiColor: "#14ECC8"};
    Sheetsee.d3PieChart(pieData, pieOptions);

    var helpers = Sheetsee.getOccurance(data, "helper");
    var barData = Sheetsee.makeColorArrayOfObject(helpers, colors, "helper");
    var barOptions = {labels: "helper", units: "units", m: [15, 120, 0, 200],
                      w: 800, h: 800, div: "#helpers", hiColor: "#14ECC8"};
    Sheetsee.d3BarChart(barData, barOptions);
 }
</script>

</body>
</html>
